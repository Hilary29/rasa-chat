version: "3.1"

rules:
- rule: Salutation
  steps:
  - intent: greet
  - action: utter_greet

- rule: Au revoir
  steps:
  - intent: goodbye
  - action: utter_goodbye

- rule: Remerciement
  steps:
  - intent: thank
  - action: utter_thank

- rule: Bot challenge
  steps:
  - intent: bot_challenge
  - action: utter_iamabot

- rule: Demande aide
  steps:
  - intent: ask_help
  - action: utter_help

- rule: Hors sujet
  steps:
  - intent: out_of_scope
  - action: utter_out_of_scope

- rule: Recherche utilisateur API
  steps:
  - intent: get_user_info
  - action: action_get_user_info

- rule: Aide carte - menu principal
  steps:
  - intent: ask_help_card
  - action: utter_ask_help_card

- rule: Aide carte virtuelle
  steps:
  - intent: virtual_card_help
  - action: utter_virtual_card_help

- rule: Aide carte physique
  steps:
  - intent: physical_card_help
  - action: utter_physical_card_help

- rule: Définition carte physique
  steps:
  - intent: what_is_physical_card
  - action: utter_what_is_physical_card

- rule: Commander carte physique
  steps:
  - intent: create_physical_card
  - action: utter_create_physical_card

- rule: Utilisation carte physique
  steps:
  - intent: physical_card_usage
  - action: utter_physical_card_usage

- rule: Livraison carte physique
  steps:
  - intent: physical_card_delivery
  - action: utter_physical_card_delivery

- rule: Utilisation carte virtuelle
  steps:
  - intent: virtual_card_usage
  - action: utter_virtual_card_usage

- rule: Contact support
  steps:
  - intent: contact_support
  - action: utter_contact_support

- rule: Demander clarification (fallback NLU)
  steps:
  - intent: nlu_fallback
  - action: action_ask_affirmation

- rule: Utilisateur ne peut pas être aidé
  steps:
  - intent: cant_help
  - action: utter_cant_help

- rule: Pourquoi Neero
  steps:
  - intent: why_neero
  - action: utter_why_neero

- rule: Chitchat
  steps:
  - intent: chitchat
  - action: utter_chitchat

# === REGLES DU FORMULAIRE DE TRANSFERT ===

- rule: Activer le formulaire de transfert
  steps:
  - intent: request_transfer
  - action: transfer_form
  - active_loop: transfer_form

- rule: Soumettre le formulaire de transfert
  condition:
  - active_loop: transfer_form
  steps:
  - action: transfer_form
  - active_loop: null
  - action: action_submit_transfer

- rule: Confirmer le transfert
  steps:
  - intent: confirm_transfer
  - action: utter_transfer_initiated
  - action: action_clear_transaction_slots
  - action: utter_ask_feedback

- rule: Annuler le transfert
  steps:
  - intent: cancel_transfer
  - action: utter_transfer_cancelled
  - action: action_clear_transaction_slots
  - action: utter_anything_else

- rule: Feedback positif
  steps:
  - intent: feedback
  - action: utter_thanks_feedback
  - action: utter_anything_else

- rule: Autre chose - oui
  steps:
  - action: utter_anything_else
  - intent: affirm
  - action: utter_what_help

- rule: Autre chose - non
  steps:
  - action: utter_anything_else
  - intent: goodbye
  - action: utter_goodbye

- rule: Explication pendant transfert
  condition:
  - active_loop: transfer_form
  steps:
  - intent: explain
  - action: action_explain_transfer_form
  - action: transfer_form
  - active_loop: transfer_form

- rule: Hors sujet pendant transfert
  condition:
  - active_loop: transfer_form
  steps:
  - intent: out_of_scope
  - action: utter_out_of_scope
  - action: transfer_form
  - active_loop: transfer_form

- rule: Contact support pendant transfert
  condition:
  - active_loop: transfer_form
  steps:
  - intent: contact_support
  - action: utter_contact_support
  - action: transfer_form
  - active_loop: transfer_form

- rule: Chitchat pendant transfert
  condition:
  - active_loop: transfer_form
  steps:
  - intent: chitchat
  - action: utter_chitchat
  - action: transfer_form
  - active_loop: transfer_form

- rule: Annuler pendant transfert (deny)
  condition:
  - active_loop: transfer_form
  steps:
  - intent: deny
  - action: utter_transfer_cancelled
  - action: action_deactivate_loop
  - active_loop: null
  - action: action_clear_transaction_slots

